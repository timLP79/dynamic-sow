<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dynamic SOW - Flowchart Generator</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="css/main.css">
</head>
<body>
  <div class="d-flex vh-100">
    <!-- Left Panel: Product Selection (Offcanvas on mobile, visible sidebar on desktop) -->
    <div class="offcanvas-md offcanvas-start border-end"
         tabindex="-1" id="sidebarPanel" aria-labelledby="sidebarLabel"
         style="width: 360px;">

      <!-- Mobile only: title bar with close button -->
      <div class="offcanvas-header border-bottom d-md-none">
        <h5 class="offcanvas-title" id="sidebarLabel">Dynamic SOW</h5>
        <button type="button" class="btn-close" data-bs-dismiss="offcanvas" data-bs-target="#sidebarPanel" aria-label="Close"></button>
      </div>

      <div class="offcanvas-body d-flex flex-column flex-grow-1 p-0">
        <header class="panel-header d-none d-md-block">
          <h1>Dynamic SOW</h1>
          <p class="subtitle">Select a product to view flowchart</p>
        </header>

        <div class="product-cards" id="productCards">
          <!-- Product cards will be generated dynamically by JavaScript -->
        </div>

        <footer class="export-actions">
          <button id="exportSVG" class="btn btn-primary w-100" disabled>
            <svg width="16" height="16" viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M8 11V3M8 11L5 8M8 11L11 8"/>
              <path d="M2 13h12"/>
            </svg>
            Download SVG
          </button>
          <button id="exportPNG" class="btn btn-primary w-100" disabled>
            <svg width="16" height="16" viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M8 11V3M8 11L5 8M8 11L11 8"/>
              <path d="M2 13h12"/>
            </svg>
            Download PNG
          </button>
        </footer>
      </div>
    </div>

    <!-- Right Panel: Flowchart Display -->
    <main class="d-flex flex-column flex-grow-1">
      <header class="panel-header">
        <button class="btn btn-light d-md-none me-2 p-1" type="button"
                data-bs-toggle="offcanvas" data-bs-target="#sidebarPanel"
                aria-controls="sidebarPanel" aria-label="Open menu">
          <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
            <rect y="3" width="20" height="2" rx="1"/>
            <rect y="9" width="20" height="2" rx="1"/>
            <rect y="15" width="20" height="2" rx="1"/>
          </svg>
        </button>
        <h2 id="flowchartTitle">Flowchart</h2>
      </header>

      <div class="flowchart-container" id="flowchartContainer">
        <div class="empty-state">
          <svg width="64" height="64" viewBox="0 0 64 64" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="8" y="16" width="48" height="32" rx="4"/>
            <path d="M16 24h32M16 32h32M16 40h24"/>
          </svg>
          <p>Select a product from the left panel to view its flowchart</p>
        </div>
      </div>
    </main>
  </div>

  <!-- Libraries -->
  <script type="module">
    import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
    window.mermaid = mermaid;
  </script>
  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>

  <!-- Application Modules -->
  <script type="module" src="js/flowchart-data.js"></script>
  <script type="module" src="js/renderer.js"></script>
  <script type="module" src="js/exporter.js"></script>
  <script type="module" src="js/app.js"></script>

  <!-- Bootstrap 5 JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
